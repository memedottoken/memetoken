import{T as N,O as E,D as k,r as P,n as L,q,d as F,f as l,e as n,u as r,w as u,t as i,F as S,g as O,y as j,o as f,i as p,B as x,l as W}from"./vue-i18n-locales.generated-DazkPcQT.js";import{_ as H}from"./ChainInfo-kmUi_szT.js";import{_ as d}from"./FormInput-DeHhKyjW.js";import{_ as R}from"./FormSwitch-C28q73Dg.js";import{L as z}from"./Loading-C3NjX0uh.js";import{_ as U}from"./PrimaryButton-CA1FRb4P.js";import{u as G,a as J,_ as K}from"./useContractCall-CIWWli1W.js";import{i as w}from"./explorers-DVbKGEgl.js";import{u as Q}from"./useChainId-PVOZb_kK.js";import{u as X}from"./useAccount-CGBMXWeW.js";import{p as h}from"./parseEther-f9fnxYOQ.js";import{p as Y}from"./sepolia-CvxlrZeJ.js";import"./NetworkIcon-DeBWGLsL.js";import"./blast-BTKMzCxo.js";import"./zora-DMUnMQki.js";import"./wagmi-CDY-DwX3.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./useConfig-BkRNL90S.js";import"./plugin-DEBxRKPP.js";import"./getPublicClient-0BHvZHD6.js";import"./public-CBg5kwGr.js";import"./secp256k1-DxfVsibD.js";import"./index-CxlER5gv.js";const Z={class:"card sm:p-12 h-full border-0 card-border"},ee={class:"card-body card-gutterless h-full"},oe={class:"grid sm:grid-cols-2 lg:grid-cols-4 gap-4"},re={class:"sm:col-span-2 lg:col-span-4 grid md:grid-cols-2 lg:grid-cols-4 gap-3 p-6 border border-gray-750"},te={class:"sm:col-span-2 lg:col-span-4"},ae={key:0,class:"pt-5 sm:col-span-2 grid gap-3 lg:col-span-4"},se={class:"flex items-center gap-3"},ne={key:1,class:"pt-5 sm:col-span-2 lg:col-span-4"},le={class:"flex items-center gap-3"},$e={__name:"CreateForm",props:{foundry:{required:!0,type:Object},config:{required:!0,type:Object}},setup(_){const m=_,g=Q(),{address:C,chain:c}=X(),e=N({name:"My Factory",chainId:g.value,foundry:"",contract:"",lock:"",fees:.1,virtualEth:0,preBondingTarget:0,bondingTarget:0,minContribution:0,poolFee:0,sellFee:0,uniswapV3Factory:0,positionManager:0,weth:0,feeTo:0,...m.config[g.value]??{},feeTo:C.value});E(g,a=>{if(e.chainId=a,m.config[a]){const o=m.config[a];e.virtualEth=o.virtualEth,e.preBondingTarget=o.preBondingTarget,e.bondingTarget=o.bondingTarget,e.minContribution=o.minContribution,e.poolFee=o.poolFee,e.sellFee=o.sellFee,e.uniswapV3Factory=o.uniswapV3Factory,e.positionManager=o.positionManager,e.weth=o.weth}}),E(C,a=>{e.feeTo=a});const M=()=>e.post(window.route("admin.factories.store")),$=k(()=>Object.keys(m.foundry.addresses)),v=k(()=>m.foundry.addresses[g.value]),y=G(m.foundry.abi,v),b=P(!1),{fees:B,feesFormatted:I,loadFees:A}=J(m.foundry.abi,v,"getDeploymentFee");L(A);const D=async()=>{var V,t,s,T;e.clearErrors();const a={virtualEth:h(`${e.virtualEth}`),preBondingTarget:0,bondingTarget:h(`${e.bondingTarget}`),minContribution:h(`${e.minContribution}`),poolFee:`${e.poolFee}`,sellFee:`${e.sellFee}`,uniswapV3Factory:w(e.uniswapV3Factory),positionManager:w(e.positionManager),weth:w(e.weth),feeTo:w(e.feeTo)};if(e.name||e.setError("name","Please create a name"),e.fees||e.setError("fees","Cannot be empty or 0"),a.virtualEth||e.setError("virtualEth","Cannot be empty or 0"),a.bondingTarget||e.setError("bondingTarget","Cannot be empty or 0"),a.minContribution||e.setError("minContribution","Cannot be empty or 0"),a.poolFee||e.setError("poolFee","Cannot be empty or 0"),a.feeTo||e.setError("feeTo","Invalid address"),a.uniswapV3Factory||e.setError("uniswapV3Factory","Invalid address"),a.positionManager||e.setError("positionManager","Invalid address"),a.weth||e.setError("weth","Invalid address"),e.hasErrors){y.error="It seems you missed you stuff we need. check the form!";return}if(await y.call("deploySystem",[C.value,h("0.1"),a],B.value),y.error)return;const o=Y({abi:m.foundry.abi,logs:y.receipt.logs,eventName:["SystemDeployed"]});e.foundry=v.value,e.contract=(t=(V=o==null?void 0:o[0])==null?void 0:V.args)==null?void 0:t.factoryAddress,e.lock=(T=(s=o==null?void 0:o[0])==null?void 0:s.args)==null?void 0:T.lockAddress,e.chainId=g.value,M()};return(a,o)=>{const V=q("appkit-network-button");return f(),F("div",Z,[l("div",ee,[l("div",oe,[n(V),n(d,{label:"Factory Name. (A simple label for your private use)",modelValue:r(e).name,"onUpdate:modelValue":o[0]||(o[0]=t=>r(e).name=t),class:"sm:col-span-2",type:"text",help:"This name is meant for local use",error:r(e).errors.name},null,8,["modelValue","error"]),l("div",re,[n(d,{label:"Deployment Fees",modelValue:r(e).fees,"onUpdate:modelValue":o[1]||(o[1]=t=>r(e).fees=t),help:"Price of launching on your platform",type:"text",error:r(e).errors.fees},{trail:u(()=>{var t,s;return[p(i((s=(t=r(c))==null?void 0:t.nativeCurrency)==null?void 0:s.symbol),1)]}),_:1},8,["modelValue","error"]),n(d,{label:"Virtual Liquidity",modelValue:r(e).virtualEth,"onUpdate:modelValue":o[2]||(o[2]=t=>r(e).virtualEth=t),error:r(e).errors.virtualEth,type:"text"},{trail:u(()=>{var t,s;return[p(i((s=(t=r(c))==null?void 0:t.nativeCurrency)==null?void 0:s.symbol),1)]}),_:1},8,["modelValue","error"]),n(d,{label:"Bonding Target",modelValue:r(e).bondingTarget,"onUpdate:modelValue":o[3]||(o[3]=t=>r(e).bondingTarget=t),error:r(e).errors.bondingTarget,type:"text"},{trail:u(()=>{var t,s;return[p(i((s=(t=r(c))==null?void 0:t.nativeCurrency)==null?void 0:s.symbol),1)]}),_:1},8,["modelValue","error"]),n(d,{label:"Min Contribution",modelValue:r(e).minContribution,"onUpdate:modelValue":o[4]||(o[4]=t=>r(e).minContribution=t),error:r(e).errors.minContribution,type:"text"},{trail:u(()=>{var t,s;return[p(i((s=(t=r(c))==null?void 0:t.nativeCurrency)==null?void 0:s.symbol),1)]}),_:1},8,["modelValue","error"]),n(d,{label:"Uniswap Pool Percentage Fees Tier (*10000)",help:"Liquidity will be added to uniswap under this fee tier",class:"md:col-span-2",modelValue:r(e).poolFee,"onUpdate:modelValue":o[5]||(o[5]=t=>r(e).poolFee=t),error:r(e).errors.poolFee,type:"text"},{trail:u(()=>[p(i((r(e).poolFee/1e4).toFixed(4)*1)+"% ",1)]),_:1},8,["modelValue","error"]),n(d,{label:"Sell Token Fees (Percent x 100)",help:"A fee charged when users sell tokens on the bonding curve",class:"md:col-span-2",modelValue:r(e).sellFee,"onUpdate:modelValue":o[6]||(o[6]=t=>r(e).sellFee=t),error:r(e).errors.sellFee,type:"text"},{trail:u(()=>[p(i((r(e).sellFee/100).toFixed(4)*1)+"% ",1)]),_:1},8,["modelValue","error"]),l("div",te,[o[13]||(o[13]=l("h3",{class:"!text-red-500"}," Important ! ",-1)),o[14]||(o[14]=l("p",{class:"mb-3"}," Donot Edit edit the UniswapV3 addresses unless you know what you are doing. Wrong addresses could lead to contributions getting stuck for good on the launchpad pool. ",-1)),n(R,{modelValue:b.value,"onUpdate:modelValue":o[7]||(o[7]=t=>b.value=t)},{default:u(()=>o[12]||(o[12]=[p(" I want to change the UniswapV3 addresses ")])),_:1},8,["modelValue"])]),n(d,{label:"UniswapV3 Factory",class:"md:col-span-2",disabled:!b.value,modelValue:r(e).uniswapV3Factory,"onUpdate:modelValue":o[8]||(o[8]=t=>r(e).uniswapV3Factory=t),error:r(e).errors.uniswapV3Factory,type:"text"},null,8,["disabled","modelValue","error"]),n(d,{label:"UniswapV3 Nonfungible Position Manager",class:"md:col-span-2",disabled:!b.value,modelValue:r(e).positionManager,"onUpdate:modelValue":o[9]||(o[9]=t=>r(e).positionManager=t),error:r(e).errors.positionManager,type:"text"},null,8,["disabled","modelValue","error"]),n(d,{label:"UniswapV3 WETH",class:"md:col-span-2",disabled:!b.value,modelValue:r(e).weth,"onUpdate:modelValue":o[10]||(o[10]=t=>r(e).weth=t),error:r(e).errors.weth,type:"text"},null,8,["disabled","modelValue","error"]),n(d,{label:"Pool Fees sent to",class:"md:col-span-2",modelValue:r(e).feeTo,"onUpdate:modelValue":o[11]||(o[11]=t=>r(e).feeTo=t),error:r(e).errors.feeTo,type:"text"},null,8,["modelValue","error"])]),v.value?(f(),F("div",ne,[n(K,{class:"my-5",state:r(y)},null,8,["state"]),l("div",le,[n(U,{secondary:"",as:"button",href:a.route("admin.factories.index"),type:"button",link:""},{default:u(()=>[p(i(a.$t("Cancel")),1)]),_:1},8,["href"]),n(U,{type:"button",onClick:j(D,["prevent"]),disabled:r(e).processing},{default:u(()=>{var t,s;return[r(e).processing?(f(),x(z,{key:0,class:"mr-2 -ml-1 inline-block w-5 h-5"})):W("",!0),p(" "+i(a.$t("Deploy Factory"))+" "+i(r(I))+" "+i((s=(t=r(c))==null?void 0:t.nativeCurrency)==null?void 0:s.symbol),1)]}),_:1},8,["disabled"])])])):(f(),F("div",ae,[l("h3",null,i(r(c).name)+" is not supported",1),o[15]||(o[15]=l("p",null,"Allowed chains are",-1)),l("div",se,[(f(!0),F(S,null,O($.value,t=>(f(),x(H,{"chain-id":t,key:t},null,8,["chain-id"]))),128))]),o[16]||(o[16]=l("h3",{class:"text-sm"},"Switch Chain",-1)),n(V)]))])])])}}};export{$e as default};
