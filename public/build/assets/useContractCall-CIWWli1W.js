import{o as z,d as D,t as M,f as K,P as V,l as Q,ak as Y,r as h,X as x,D as _,O as F}from"./vue-i18n-locales.generated-DazkPcQT.js";import{u as ee,i as v}from"./explorers-DVbKGEgl.js";import{u as q}from"./useAccount-CGBMXWeW.js";import{u as I}from"./useConfig-BkRNL90S.js";import{g as A}from"./getPublicClient-0BHvZHD6.js";import{u as Z}from"./useChainId-PVOZb_kK.js";import{n as N,R as te,g as se,W as d,B as ae}from"./blast-BTKMzCxo.js";import{ac as ne,b as oe,d as re,e as j,f as ie,k as X,i as ce,s as ue,ad as H,ae as U}from"./sepolia-CvxlrZeJ.js";import{a4 as G,a5 as W,a6 as le,$ as de,a7 as pe,a8 as fe}from"./wagmi-CDY-DwX3.js";import{g as ge,v as me,s as he}from"./public-CBg5kwGr.js";import{h as y}from"./index-CxlER5gv.js";async function ye(t,{chain:s}){const{id:r,name:e,nativeCurrency:a,rpcUrls:o,blockExplorers:n}=s;await t.request({method:"wallet_addEthereumChain",params:[{chainId:N(r),chainName:e,nativeCurrency:a,rpcUrls:o.default.http,blockExplorerUrls:n?Object.values(n).map(({url:i})=>i):void 0}]},{dedupe:!0,retryCount:0})}function we(t,s){const{abi:r,args:e,bytecode:a,...o}=s,n=ne({abi:r,args:e,bytecode:a});return G(t,{...o,data:n})}async function Ce(t){var r;return((r=t.account)==null?void 0:r.type)==="local"?[t.account.address]:(await t.request({method:"eth_accounts"},{dedupe:!0})).map(e=>te(e))}async function ke(t){return await t.request({method:"wallet_getPermissions"},{dedupe:!0})}async function Te(t){return(await t.request({method:"eth_requestAccounts"},{dedupe:!0,retryCount:0})).map(r=>se(r))}async function ve(t,s){return t.request({method:"wallet_requestPermissions",params:[s]},{retryCount:0})}async function be(t,s){var u,p,g,f;const{account:r=t.account,chain:e=t.chain,...a}=s;if(!r)throw new W({docsPath:"/docs/actions/wallet/signTransaction"});const o=X(r);oe({account:o,...s});const n=await re(t,j,"getChainId")({});e!==null&&le({currentChainId:n,chain:e});const i=(e==null?void 0:e.formatters)||((u=t.chain)==null?void 0:u.formatters),c=((p=i==null?void 0:i.transactionRequest)==null?void 0:p.format)||ie;return o.signTransaction?o.signTransaction({...a,chainId:n},{serializer:(f=(g=t.chain)==null?void 0:g.serializers)==null?void 0:f.transaction}):await t.request({method:"eth_signTransaction",params:[{...c(a),chainId:N(n),from:o.address}]},{retryCount:0})}async function Fe(t,s){const{account:r=t.account,domain:e,message:a,primaryType:o}=s;if(!r)throw new W({docsPath:"/docs/actions/wallet/signTypedData"});const n=X(r),i={EIP712Domain:ge({domain:e}),...s.types};if(me({domain:e,message:a,primaryType:o,types:i}),n.signTypedData)return n.signTypedData({domain:e,message:a,primaryType:o,types:i});const c=he({domain:e,message:a,primaryType:o,types:i});return t.request({method:"eth_signTypedData_v4",params:[n.address,c]},{retryCount:0})}async function Ie(t,{id:s}){await t.request({method:"wallet_switchEthereumChain",params:[{chainId:N(s)}]},{retryCount:0})}async function Ae(t,s){return await t.request({method:"wallet_watchAsset",params:s},{retryCount:0})}function Pe(t){return{addChain:s=>ye(t,s),deployContract:s=>we(t,s),getAddresses:()=>Ce(t),getChainId:()=>j(t),getPermissions:()=>ke(t),prepareTransactionRequest:s=>ce(t,s),requestAddresses:()=>Te(t),requestPermissions:s=>ve(t,s),sendRawTransaction:s=>ue(t,s),sendTransaction:s=>G(t,s),signMessage:s=>de(t,s),signTransaction:s=>be(t,s),signTypedData:s=>Fe(t,s),switchChain:s=>Ie(t,s),watchAsset:s=>Ae(t,s),writeContract:s=>pe(t,s)}}const m="0x0000000000000000000000000000000000000000";async function Be(t,s={}){return(await fe(t,s)).extend(Pe)}const Ee={key:0,class:"mt-1 p-3 bg-red-300/10 !text-red-400 text-sm font-mono"},qe=["href"],Ue={__name:"TxStatus",props:{state:Object},setup(t){return(s,r)=>t.state.error?(z(),D("p",Ee,M(t.state.error),1)):(z(),D("p",{key:1,class:V([t.state.isConfirmed?"!text-green-500 bg-green-300/10":"!text-gray-200 bg-gray-750","p-3 text-sm font-mono"])},[K("span",{class:V({"text-green-500":t.state.isConfirmed})},M(t.state.status),3),t.state.txhash?(z(),D("a",{key:0,href:t.state.etherScanLink,class:"ml-2 mt-1 text-emerald-500",target:"_blank"},M(t.state.shortTx),9,qe)):Q("",!0)],2))}},xe=[{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"positions",outputs:[{internalType:"uint96",name:"nonce",type:"uint96"},{internalType:"address",name:"operator",type:"address"},{internalType:"address",name:"token0",type:"address"},{internalType:"address",name:"token1",type:"address"},{internalType:"uint24",name:"fee",type:"uint24"},{internalType:"int24",name:"tickLower",type:"int24"},{internalType:"int24",name:"tickUpper",type:"int24"},{internalType:"uint128",name:"liquidity",type:"uint128"},{internalType:"uint256",name:"feeGrowthInside0LastX128",type:"uint256"},{internalType:"uint256",name:"feeGrowthInside1LastX128",type:"uint256"},{internalType:"uint128",name:"tokensOwed0",type:"uint128"},{internalType:"uint128",name:"tokensOwed1",type:"uint128"}],stateMutability:"view",type:"function"}],Le=t=>t.replace(/[0-9]{2,}/g,s=>` ${s} `).replace(/[^A-Z0-9][A-Z]/g,s=>`${s[0]} ${s[1]}`).replace(/[A-Z][A-Z][^A-Z0-9]/g,s=>`${s[0]} ${s[1]}${s[2]}`).replace(/[ ]{2,}/g,s=>" ").replace(/\s./g,s=>s.toUpperCase()).replace(/^./,s=>s.toUpperCase()).trim(),Ze=(t,s)=>{const{address:r}=q(),{t:e}=Y(),a=h(null),o=h(null),n=h(null),i=h(null),c=h(""),u=h(!1),p=h(!1),g=h(null),f=h(null),[w,l]=ee(f),T=I(),b=A(T);return x({error:o,txhash:f,busy:a,shortTx:w,tx:w,txlink:l,status:c,etherScanLink:l,confirming:u,isConfirmed:p,simulation:n,receipt:g,called:i,call:async(C,P,B,O)=>{i.value=C,p.value=!1,o.value=null,g.value=null,f.value=null,u.value=!1,a.value=C,n.value=C,c.value=e("Sending Transaction ..."),console.log(T);const J=await Be(T),E=await b.simulateContract({address:y(s),abi:y(t),functionName:C,account:r.value,args:P,value:B??0}).catch(k=>{var $;if(console.log(k),c.value=null,k instanceof ae){const S=k.walk(R=>R instanceof U);if(S instanceof U){const R=(($=S.data)==null?void 0:$.errorName)??"";o.value=Le(R);return}return o.value=k.shortMessage}});if(n.value=null,o.value||!(E!=null&&E.request)){a.value=null;return}if(f.value=await J.writeContract(E.request).catch(k=>{o.value=k.shortMessage??k.detials}),o.value){c.value=null,a.value=null;return}typeof O=="function"&&O(f.value),u.value=!0,c.value=e("Confirming Tx ..."),g.value=await b.waitForTransactionReceipt({hash:f.value}),c.value=e("Tx Complete"),u.value=!1,p.value=!0,a.value=null,setTimeout(()=>{p.value=!1},3e4)}})},je=(t,s,r="fees")=>{const e=A(I()),a=h(0n),o=_(()=>d(a.value)),n=Z(),i=async()=>{a.value=await e.readContract({abi:y(t),address:y(s),functionName:r})};return F([n,()=>y(t),()=>y(s)],([c,u,p])=>{!c||!p||!u||i()},{immediate:!0}),{fees:a,feesFormatted:o}},Xe=(t,s,r="getBondingCurveSettings")=>{const e=A(I()),a=x({virtualEth:0,preBondingTarget:0,bondingTarget:0,minContribution:0,poolFee:0,sellFee:0,uniswapV3Factory:0,positionManager:0,weth:0,feeTo:0,load:async()=>null}),o=Z();return a.load=async()=>{const n=await e.readContract({abi:t,address:y(s),functionName:r});a.virtualEth=d(n.virtualEth),a.preBondingTarget=d(n.preBondingTarget),a.bondingTarget=d(n.bondingTarget),a.minContribution=d(n.minContribution),a.poolFee=n.poolFee,a.sellFee=n.sellFee,a.uniswapV3Factory=n.uniswapV3Factory,a.positionManager=n.positionManager,a.weth=n.weth,a.feeTo=n.feeTo},F(o,n=>{n&&y(s)&&a.load()},{immediate:!0}),a},Ge=t=>{const{address:s,chainId:r}=q(),e=x({owner:m,isOwner:!1,isFinalized:!1,currentPhase:0,balance:0,updateBalance:()=>null,updateInfo:()=>null,updateTokenBalance:()=>null,phase:null,totalPreBondingContributions:0,totalETHCollected:0,virtualEth:0n,virtualEthFormatted:0,preBondingTarget:0,bondingTarget:0,minContribution:0,ethReserve:0n,tokenReserve:0n,tokenBalance:0n,poolFee:0,sellFee:0,contributions:0,tokenLocks:!1,tokenAllocations:0,uniswapV3Factory:m,positionManager:m,uniswapPool:m,weth:m,feeTo:m});e.phase=_(()=>["Prebonding","Bonding","Finalized"][e.currentPhase]??"Prebonding"),e.isOwner=_(()=>`${e.owner}`.toLowerCase()===`${s.value}`.toLowerCase());const a=A(I());return e.updateBalance=async()=>{const o=await a.readContract({abi:H,address:y(t.token),functionName:"balanceOf",args:[e.owner]});e.balance=d(o)},e.updateTokenBalance=async()=>{const o=await a.readContract({abi:H,address:y(t.token),functionName:"balanceOf",args:[t.contract]});e.tokenBalance=o},F(()=>e.owner,o=>{o!==m&&e.updateBalance()},{immediate:!0}),e.updateInfo=async()=>{const o={address:t.contract,abi:t.factory.abi},n={uniswapPool:[],owner:[],isFinalized:[],currentPhase:[],totalETHCollected:[],totalPreBondingContributions:[],getBondingCurveSettings:[],ethReserve:[],tokenReserve:[],contributions:[s.value],tokenLocks:[s.value],tokenAllocations:[s.value]},i=await a.multicall({contracts:Object.keys(n).map(B=>({...o,functionName:B,args:n[B]}))}),[c,u,p,g,f,w,l,T,b,L,C,P]=i;u.status==="success"&&(e.owner=u.result),c.status==="success"&&(e.uniswapPool=c.result),p.status==="success"&&(e.isFinalized=p.result),g.status==="success"&&(e.currentPhase=g.result),f.status==="success"&&(e.totalETHCollected=d(f.result)),w.status==="success"&&(e.totalPreBondingContributions=d(w.result)),T.status==="success"&&(e.ethReserve=T.result),b.status==="success"&&(e.tokenReserve=b.result),L.status==="success"&&(e.contributions=d(L.result)),C.status==="success"&&(e.tokenLocks=C.result),P.status==="success"&&(e.tokenAllocations=d(P.result)),l.status==="success"&&(e.virtualEth=l.result.virtualEth,e.virtualEthFormatted=d(l.result.virtualEth),e.preBondingTarget=d(l.result.preBondingTarget),e.bondingTarget=d(l.result.bondingTarget),e.minContribution=d(l.result.minContribution),e.poolFee=l.result.poolFee/1e4,e.sellFee=l.result.sellFee/1e4,e.uniswapV3Factory=v(l.result.uniswapV3Factory),e.positionManager=v(l.result.positionManager),e.weth=v(l.result.weth),e.feeTo=v(l.result.feeTo)),await e.updateTokenBalance()},F(r,()=>{e.updateInfo()},{immediate:!0}),e},We=t=>{const s=A(I()),{address:r}=q(),e=x({positionManager:m,token:m,lockContract:m,lpTokenId:0n,isFinalized:0n,currentPhase:null,weth:m,owner:m,isLocked:!0,lockedAt:0n,unlocksAt:0n,tokenFees:0n,wethFees:0n,stokenFees:0n,swethFees:0n,updateInfo:async()=>null,updateCheckFees:async()=>null});e.updateInfo=async()=>{const o={address:t.contract,abi:t.factory.abi},n={token:[],lockContract:[],lpTokenId:[],isFinalized:[],currentPhase:[],getBondingCurveSettings:[]},i=await s.multicall({contracts:Object.keys(n).map(l=>({...o,functionName:l,args:n[l]}))}),[c,u,p,g,f,w]=i;c.status==="success"&&(e.token=c.result),u.status==="success"&&(e.lockContract=u.result),p.status==="success"&&(e.lpTokenId=p.result),g.status==="success"&&(e.isFinalized=g.result),f.status==="success"&&(e.currentPhase=f.result),w.status==="success"&&(e.positionManager=v(w.result.positionManager),e.weth=v(w.result.weth)),e.isFinalized&&await e.updateCheckFees()},e.updateCheckFees=async()=>{const[o,,n,i]=await s.readContract({abi:t.factory.lock_abi,address:t.factory.lock,functionName:"lockedNFTs",args:[e.lpTokenId]});e.owner=o,e.isLocked=n,e.lockedAt=i,e.unlocksAt=parseInt(i)+60*60*24*365*10;const[,,c]=await s.readContract({abi:xe,address:e.positionManager,functionName:"positions",args:[e.lpTokenId]}),u=await s.simulateContract({account:r.value,abi:t.factory.lock_abi,address:t.factory.lock,functionName:"claimFees",args:[e.lpTokenId]});`${c}`.toLowerCase()===`${e.weth}`.toLocaleLowerCase()?(e.wethFees=d(u.result[0]),e.tokenFees=d(u.result[1])):(e.wethFees=d(u.result[1]),e.tokenFees=d(u.result[0]))};const{chainId:a}=q();return F(a,()=>{e.updateInfo()},{immediate:!0}),e};export{Ue as _,je as a,Xe as b,Ge as c,We as d,Ze as u,m as z};
