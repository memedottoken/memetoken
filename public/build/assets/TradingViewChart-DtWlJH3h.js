import{L as m,M as h,d as y,f as _,o as b}from"./vue-i18n-locales.generated-DazkPcQT.js";const w={class:"relative"},v={__name:"TradingViewChart",props:{launchpad:{type:Object,required:!0}},setup(u){const o=u;let l=null;const c=()=>new window.TradingView.widget({symbol:o.launchpad.symbol,interval:"60",container:"tv_chart_container",library_path:"/charting_library/",locale:"en",disabled_features:["use_localstorage_for_settings","header_saveload","chart_template_storage"],client_id:"tradingview.com",user_id:"public_user",fullscreen:!1,autosize:!0,theme:"Dark",custom_css_url:"/tradingview.css",overrides:{"paneProperties.backgroundType":"solid","paneProperties.background":"#262626","paneProperties.vertGridProperties.color":"#333333","paneProperties.horzGridProperties.color":"#333333","scalesProperties.backgroundColor":"#262626","scalesProperties.lineColor":"#333333","scalesProperties.textColor":"#8b8b8b","crossHairProperties.color":"#636363","crossHairProperties.style":0,"mainSeriesProperties.style":1,"mainSeriesProperties.showPriceLine":!0,volumePaneSize:"medium","volume.volume.color.0":"#ef4444","volume.volume.color.1":"#22c55e","mainSeriesProperties.candleStyle.upColor":"#26a69a","mainSeriesProperties.candleStyle.downColor":"#ef5350","mainSeriesProperties.candleStyle.borderUpColor":"#26a69a","mainSeriesProperties.candleStyle.borderDownColor":"#ef5350","mainSeriesProperties.candleStyle.wickUpColor":"#26a69a","mainSeriesProperties.candleStyle.wickDownColor":"#ef5350"},datafeed:{onReady:async a=>{await a({supported_resolutions:["1","5","15","30","60","240","D","W"],currency_codes:["USD"],supports_marks:!1,supports_time:!0,supports_timescale_marks:!1})},searchSymbols:(a,e,s,n)=>{n([{symbol:o.launchpad.symbol,full_name:o.launchpad.symbol,description:o.launchpad.symbol,exchange:"DEX",type:"crypto"}])},resolveSymbol:async(a,e,s)=>{await e({name:o.launchpad.symbol,full_name:o.launchpad.symbol,description:o.launchpad.symbol,type:"crypto",session:"24x7",timezone:"Etc/UTC",ticker:o.launchpad.symbol,minmov:1,pricescale:1e8,has_intraday:!0,intraday_multipliers:["1","5","15","30","60","240"],supported_resolutions:["1","5","15","30","60","240","D","W"],volume_precision:8,data_status:"streaming"})},getBars:async(a,e,s,n,p)=>{try{const r=await fetch(`/api/launchpad/${o.launchpad.contract}/candles?timeframe=${e}&from=${s.from}&to=${s.to}`);if(!r.ok)throw new Error("Network response was not ok");const i=await r.json();if(i.length===0){n([],{noData:!0});return}const d=i.map(t=>({time:t.timestamp*1e3,open:parseFloat(t.open),high:parseFloat(t.high),low:parseFloat(t.low),close:parseFloat(t.close),volume:parseFloat(t.volume)}));n(d,{noData:!1})}catch(r){console.error("Error fetching candles:",r),p(r)}},subscribeBars:(a,e,s,n,p)=>{window.Echo.channel(`launchpad.${o.launchpad.id}`).listen("NewTradeEvent",r=>{const i={time:new Date(r.created_at).getTime(),open:parseFloat(r.amount),high:parseFloat(r.amount),low:parseFloat(r.amount),close:parseFloat(r.amount),volume:parseFloat(r.qty)};s(i)})},unsubscribeBars:a=>{window.Echo.leave(`launchpad.${o.launchpad.id}`)}}});return m(async()=>{const a="/charting_library/charting_library.js";if(document.querySelector(`script[src="${a}"]`))l=c();else{const e=document.createElement("script");e.src=a,e.type="text/javascript",document.head.appendChild(e),e.onload=()=>{l=c()}}}),h(()=>{l&&(l.remove(),l=null),window.Echo.leave(`launchpad.${o.launchpad.id}`)}),(a,e)=>(b(),y("div",w,e[0]||(e[0]=[_("div",{id:"tv_chart_container",class:"w-full h-[400px]"},null,-1)])))}};export{v as default};
